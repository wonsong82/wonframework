(function(a){a.fn.uploader=function(b){var c=a(this);b=a.extend({},a.fn.uploader.defaultArgs,b);b.name=c.attr("id");if(!b.action){throw"PHP File Handler is missing";return false}c.click(function(){var g=a('<div id="'+b.name+'"></div>');var f=a("<div/>").css({position:"fixed",width:"100%",height:"100%",background:"#000",opacity:0.5,top:"0px",left:"0px"}).appendTo(g);var i=a("<form/>").css({width:"260px",height:"30px",background:"#fff",position:"fixed",top:"50%",left:"50%","margin-top":"-20px","margin-left":"-130px",padding:"20px","border-radius":"4px",opacity:0.8}).appendTo(g);var e=a("<label/>").css({font:"12px/12px arial",}).html("Size Limit: "+b.limit).appendTo(i);var h=a('<input type="file" name="file" accept="'+b.accept+'"/>').css({width:"auto",margin:"0px"}).appendTo(i);var d=a("<div>X</div>").css({width:"15px",height:"15px",color:"#fff",font:"bold 15px/15px arial",cursor:"pointer",margin:"0px",padding:"0px",position:"fixed",left:"50%","margin-left":"160px",top:"50%","margin-top":"-40px"}).appendTo(g);a("body").append(g);d.unbind("click");d.click(function(){g.remove();return false});a(document).unbind("keyup");a(document).keyup(function(j){if(j.keyCode==27){g.remove()}return false});i.css("display","block");d.css("display","block");h.unbind("change");h.change(function(){var m=a("<div/>").addClass("loading").css({position:"fixed",top:"50%",left:"50%"}).appendTo(g);i.css("display","none");d.css("display","none");a(document).unbind("keyup");a("#"+b.name+"_iframe").remove();var j=a('<iframe width="200" height="200" border="0" name="'+b.name+'_iframe" id="'+b.name+'_iframe"></iframe>').css({display:"none"}).appendTo(g);var l=document.getElementById(b.name+"_iframe");var k="";if(l.addEventListener){l.addEventListener("load",function(){if(l.contentDocument){k=l.contentDocument.body.innerHTML}else{if(l.contentWindow){k=l.contentWindow.document.body.innerHTML}else{if(l.document){k=l.document.body.innerHTML}}}b.success(k);g.remove()})}else{if(l.attachEvent){l.attachEvent("onload",function(){if(l.contentDocument){k=l.contentDocument.body.innerHTML}else{if(l.contentWindow){k=l.contentWindow.document.body.innerHTML}else{if(l.document){k=l.document.body.innerHTML}}}b.success(k);g.remove()})}}i.attr("target",b.name+"_iframe");i.attr("action",b.action);i.attr("method","post");i.attr("enctype","multipart/form-data");i.attr("encoding","multipart/form-data");i.submit();return false});return false})};a.fn.uploader.defaultArgs={accept:"audio/*,video/*,image/*",success:function(){},action:null,limit:"Undefined"}})(jQuery);